\documentclass[a4paper,10pt]{scrartcl}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{booktabs}
\usepackage[german]{babel}

\title{Netzwerke}
\author{}
\date{}

\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage
\section{Kapitel 1}
    \subsection{DNS - Domain Name System}
        Ein Domain Name System nimmt Internetadressen wie 'facebook.com' und liefert dessen IP-Adresse, 
        damit Rechenr sich damit verbinden können. Wobei 'com'\footnote{Eigentlich ist der Punkt rechts von der Domain. Bei der TTL wird der Punkt meistens weggelassen. Richtig heißt es beispielsweise 'com.'} eine TLD (Top Level Domain) ist. Man unterscheidet TLDs wie folgt:
        \begin{description}
            \item [gTLD] (auch: genericTLDs, allgemeine TLD) Diese werden wieder in 2 Untergruppen aufgeteilt:
                \begin{description}
                    \item [sTLD] (auch: sponsored TLD) Diese TLD werden nur an Websiten vergeben, welche bestimmte Forderungen erfüllen. '.gov'
                    \item [uTLD] (auch: unsponsered TLD) TLD werden ohne Vorgaben vergeben. '.com, .xyz' 
                \end{description} 
            \item [ccTLD] (auch: country-codeTLD) TLD die zeigen aus welchem Land die Website kommt. '.de oder .us'
        \end{description}
        Beim Beispiel von facebook.com nennt man das .facebook eine Second-Level Domain, würde da noch www. stehen wäre das die Third-Level Doamin,
        Es können (quasi) beliebig viele Subdomains eingeführt werden. Die niedrigste Subdomain heißt hierbei Lowest-Level Domain. \\
        Eine FQDN (Fully Qualieified Domain Name) setzt sich aus TopLevelDomain, LowestLevelDomain und mindestens einer Domain dazwischen zusammem.
    \subsection{LAN - Local Area Network}
        Das LAN vernetzt Geräte auf einen bestimmten (o.a. begrenzten Bereich) Normalerweise ein Haus im privaten Gebrauch oder ein Firmen-Campus etc. Dabei sind die Geräte 
        ständig miteinander verbunden. 


\section{Kapitel 2}
    \subsection{Ethernet}
        Jede Netzwerkkarte hat eine eigene MAC-Adresse, die benutzt wird damit Rechner sich gegenseitig Nachrichten schicken können. Die Nachrichten bei Ethernet werden auch
        Frames, Package und Header genannt

        \subsubsection{Kabelspezifikationen}
            Das LAN-Kabel kann je nach Spezifikation verschiedene Eigenschaften. Eine sehr frühe Version ist das 10Base5 Kabel. Damals wurde noch ein Koaxialkabel als "physikalisches Medium"
            benutzt. Außerdem musst man ein "Dropkabel" benutzen, welches dann einerseits an den Rechner angeschlossen wird und anderesiets an einen 'Transceiver', an welchem wiederum das Koaxialkabel
            angeschlossen ist. Spezifikationen:
            \[
                \begin{tabular}{|l|c|}
                    Übertragungsrate & 10Mbit \\
                    Maximale Gesamtlänge des Netzes & 2500m \\
                    Maximale Segmentlänge & 500m \\
                    Maximale Anzahl an Knoten & 1024 \\
                    Zugriffsverfahren & CSMA / CD                
                \end{tabular}
            \]
            Ein weiterer Standard ist der 10BaseT Standard. Hier löst das Twisted Pair\footnote{Ein Kabel, welches aus mehreren Kabelpaaren besteht die miteinander verdrillt sind}
            Es gibt 4 Paare im Kabel, also 8 Pins insgesamt. An einem NIC sind Pin 1 und 2 zum senden und Pin 3 und 6 zum empfangen verantwortlich. Bei Hubs und Switches ist genau das
            umgekehrt da anonsten am Etherentplug beim Switch beide auf den selben Pins senden würden und beide auf den selben Pins zuhören (auf denen aber nichts gesendet wird).
            Möchte man jetzt zwei Rechner diretk verbinden nutzt man ein Crossover Kabel welches das Sendepaar und Empfängerpaar an einem Ende des Kabels vertauscht. 
        \subsubsection{5-4-3(-2-1)-Regel}
            Wie schon erwähnt können Rechner direkt mit einem Crossover Kabel miteinander kommunizieren. Wenn das Netzt aber mehr als 2 Teilnehmer haben soll werden die Patch Kabel mit 
            ihren Transceiver benötigit. Dabei hat sich die 5-4-3 oder auch die Repeater-Regel entwickelt. Sie gilt wenn sich Netzsegmente (10 Mbit) zu einer Baumtopologie verbinden. \\
            Der Pfad zwischen 2 Rechnern verläuft durch maximal
            \[
                \begin{tabular}{ll}
                    5 & Segemte mit \\
                    4 & Repeatern verlaufen darf. Es dürfen nur an \\
                    3 & Segmente aktive Endgeräte angeschlossen sein. \\
                    2 & Segmente sind dabei Linksegmente (nur Repeater). Dies bildet \\
                    1 & Kollisionsdomaine 
                \end{tabular}
            \]   

        \subsubsection{Ethernet Brücke}
        
        \subsection{Aloha}
        
        \subsubsection{CSMA / CD (Carrier Sense Multiple Access / Collision Detection)}
            A, B und C sind Rechner im selben Netzwerk
            A und C senden zum selben Zeitpunkt, das sie merken der Kanal ist frei
            Es kommt zur Kollision die erkannt wird. Da beide Rechner den Kanal abhören merken sie,
            dass das Signal verfälschtist, brechen ab Pakete zu senden und senden JAM  und nutzen 'truncated binary exponential backoff' (Rechung wie bei Aloha) um
            nicht wieder direkt eine Kollision zu verursachen. \\
            Eine logische '0' darf nicht als 0V gesendet werden, da ein Rechner anonsten denken könnte das der Kanal frei ist obwohl gerade gesendet wird. Zur Codierung wird
            der Manchester Code beutzt. \\
            Daten werden in Ethernet zu einem Datenpaket zusammengefasst, auch 'data frame' genannt. Dieser besitzt u.a. eine Prüfsumme und Mindestlänge.
            Die Mindestlänge ist wichtig, da sich das Paket über das Kabel komplett ausbreiten muss. Am ende des Kabels ist ein Widerstand, der das Paket vernichtet
            Kommt kein signal zurück, ist die Übertragung gelungen, kommt ein Signal zurück muss ein anderer Rechner gesendet haben. Es kommt zur Kollision.
            Sobald aber A mit senden fertig ist, warten die anderen Rechner eine gewisse Zeit, bevor sie mit dem senden anfangen (interframe gap), um sischerzustellen dass
            A auch wirklich fertig ist. 
        
        \subsubsection{IEEE 802.3}

        \subsubsection{Ethernet II}

        \subsubsection{Spanning Tree}

        \subsubsection{Switching}

        \subsubsection{VLAN}
        \newpage
\section{Kapitel 3}
    \subsection{ARP - Address Resolution Protocol}
        ARP wird verwendet, wenn ein Computer oder Router ein Paket an ein Gerät im eigenen Netz senden will, aber nur die Ziel-IP-Adresse kennt. 
        Er schickt dann ein Ethernet II Frame mit dem Typ-Feld 0x608 an die Broadcast-Adresse FF-FF-FF-FF-FF-FF. Wenn der gesuchte Rechner das Paket empfängt, 
        antwortet er mit seiner MAC-Adresse. 
        \[
        \begin{tabular}{|p{2.5cm}|p{2.5cm}|p{2.5cm}|p{2.5cm}|}
            \toprule 
            1 & 2 & 3 & 4  \\
            \midrule\midrule
            \multicolumn{2}{|c|}{Hardware Type} & \multicolumn{2}{|c|}{Protocol Type} \\
            \midrule
            HLEN & PLEN & \multicolumn{2}{|c|}{Operation} \\
            \midrule
            \multicolumn{4}{|c|}{Sender Hardware Address Byte 0-3} \\
            \midrule
            \multicolumn{2}{|c|}{Sender Hardware Address Byte 4-5} & \multicolumn{2}{|c|}{Sender Internet Address Byte 0-1} \\
            \midrule
            \multicolumn{2}{|c|}{Sender Internet Address Byte 2-3} & \multicolumn{2}{|c|}{Target Hardware Address Byte 0-1}\\
            \midrule
            \multicolumn{4}{|c|}{Target Hardware Address Byte 2-5}\\
            \midrule
            \multicolumn{4}{|c|}{Target Internet Adress Byte 0-3}\\
            \bottomrule
        \end{tabular}
        \]
        Die einzelnen Felder bedeuten dabei:
        \begin{description}
            \item[Hardware Type] beschreibt, über welches Mittel kommuniziert wird. Ethernet bedeutet dabei 1.
            \item[Protocol Type] Mit welchem Protokoll soll später kommuniziert werden? Das gleiche wie bei Ethernet II, also 0x800 für IP.
            \item[HLEN] beschreibt, wie lange eine Hardware-Adresse ist. Ist bei Ethernet immer 6.
            \item[PLEN] beschreibt, wie lange eine Protokoll-Adresse ist. Ist bei IPv4 immer 4.
            \item[Operation] Was wird gerade ausgeführt? 1 für Request, 2 für Response
            \item[Sender Hardware Address] ist die MAC-Adresse des Senders
            \item[Sender Internet Address] ist die IP-Adresse des Senders
            \item[Target Hardware Address] ist die MAC-Adresse des Empfängers
            \item[Target Internet Address] ist die IP-Adresse des Enpfängers.
        \end{description}
        Die gesuchten Felder werden mit Nullen gefüllt. Mit “reverse ARP” kann ein Computer, der über das Netzwerk gebootet wurde, die IP-Adresse zu seiner eigenen MAC-Adresse erfragen. Dazu ist allerdings ein Server nötig.
    \subsection{ICMP - Internet Control Message Protocol}
        ICMP-Pakete sind in IP-Pakete eingepackt (Protocol-Feld wird auf 1 gesetzt). Es wird unter anderem verwendet, um  die Erreichbarkeit von Systemen im Internet zu testen (ping), Netzwerkfehler zu erkennen und um bei Zeitüberschreitungen benachrichtigt zu werden.\\
        
        \[
        \begin{tabular}{|p{2.5cm}|p{2.5cm}|p{2.5cm}|p{2.5cm}|}    
            \toprule 
            1 & 2 & 3 & 4  \\
            \midrule\midrule
            Type & Code & \multicolumn{2}{|c|}{Checksum}\\
            \bottomrule
        \end{tabular}
        \]
        Die gültigen Werte für das Type-Feld sind:
        \begin{description}
            \item[0:] Echo Reply (bei ping)
            \item[3:] Destination unreachable (der Sender wird benachrichtigt, wenn das Ziel nicht erreichbar ist). Die Gründe dafür können im Code-Feld stehen
            \begin{description}
            \item[0:] net unreachable
            \item[1:] host unreachable
            \item[2:] protocol unreachable
            \item[3:] port unreachable
            \item[4:] Fragmentation needed and DF set
            \item[5:] source route failed (der Sender hat eine Route im IP-Header angegeben, die nicht funktioniert hat)
            \end{description}
            \item[4:] Source Quench (der Empfänger bittet den Sender, weniger Pakete zu senden)
            \item[5:] Redirect (Wird von Routern verwendet, um die Netzwerkroute zu beeinflussen)
            \item[8:] Echo (bei ping)
            \item[11:] Time exceeded (TTL wurde unterschritten)
            \item[12:] Parameter Problem, ungültiger IP Header
            \item[13:] Timestamp (für Zeit-Synchronisierung)
            \item[14:] Timestamp Reply (für Zeit-Synchronisierung)
        \end{description}
        Durch das Code-Feld können zusätzliche Informationen mitgegeben werden, z.B. warum die Verbindung gescheitert ist.
    \subsection{TCP}
        TCP stellt eine virtuelle Verbindung zwischen den Kommunikationspartnern her. Durch die Verbindung können Daten zuverlässig übermittelt werden. Bei TCP und UDP gibt es Ports, an die die Daten gesendet werden. \emph{Well known Ports} gehen von 0 bis 1023 sind u. a.:\\
        \begin{tabular}{|c|c|}
            \hline
            Dienst & Portnummer \\
            \hline
            http & 80 \\
            https & 443 \\
            SMTP (E-Mail versenden) & 25\\
            POP3 (E-Mail abholen) & 110\\
            FTP & 20, 21 \\
            ssh & 22 \\
            \hline
        \end{tabular}  \\ 
        Damit der Server antworten kann, sendet der Client auch eine Portnummer als \emph{source port} mit, an die die Antwort geschickt werden soll. Weil sich diese Ports immer ändern können, heißen sie auch dynamische Ports. Sie gehen von Port 49152 bis 65535. Zwischen den Well known ports und den dynamic ports liegen die registered Ports von 1024 bis 49151.\\ \\
        Eine TCP-Verbindung entsteht über einen \textbf{3way Handshake}.
        \begin{description}
        \item[1. (SYN)] Der Client sendet ein Paket, bei dem das SYN-Feld gesetzt ist und mit welcher Sequence Number er beginnen möchte.
        \item[2. (ACK+SYN)] Der Server antwortet dem Client mit einem Paket, bei dem die SYN + ACK Felder gesetzt sind. Außerdem teilt er dem Client die eigene Sequence Number mit.
        \item[3. (ACK)] Der Client bestätigt die Antwort und beide bauen eine sichere Verbindung zur Kommunikation auf.
        \end{description}
        Nun kann kommuniziert werden. Der Client sendet die Daten und zählt dabei die gesendeten Bytes mit der Sequence Number hoch. Die Sequence Number ist immer ein Pointer auf das erste Byte im aktuellen Paket. Er kann nur so viele Daten wie die Window size senden, ohne auf ein acknowledgen des Servers zu warten. Der Server acknowledged ein einzelnes oder mehrere Pakete mit einem ACK-Paket. Acknowledgement Number ist dabei die als nächstes erwartete Sequence-Number des Gegenübers.\\
        Die TCP-Verbindung wird über einen \textbf{4way Handshake} geschlossen.
        \begin{description}
        \item[1. (FIN)] Der Client will die Verbindung trennen und sendet ein FIN-Paket.
        \item[2. (ACK)] Der Server bestätigt den Erhalt des FIN-Pakets.
        \item[3. (FIN)] Sobald das Programm auf dem Server bereit ist, die Verbindung zu schließen, wird ein FIN-Paket an den Client gesendet.
        \item[4. (ACK)] Der Client bestätigt den Erhalt des Pakets. Die Verbindung wird beendet.
        \end{description}
        \begin{tabular}{|p{3cm}|p{3cm}|p{3cm}|p{3cm}|}
            \toprule 
            1 & 2 & 3 & 4  \\
            \midrule\midrule
            \multicolumn{2}{|c|}{Source Port} & \multicolumn{2}{|c|}{Destination Port}\\
            \midrule
            \multicolumn{4}{|c|}{Sequence Number}\\
            \midrule
            \multicolumn{4}{|c|}{Acknowledgement Number}\\
            \midrule
            \begin{tabular}{p{12mm}|p{1cm}}
             data offset &  reserved\\
            \end{tabular} & flags &  \multicolumn{2}{|c|}{window}\\
            \midrule
            \multicolumn{2}{|c|}{checksum} & \multicolumn{2}{|c|}{urgent pointer}\\
            \midrule
            \multicolumn{4}{|c|}{options}\\
            \multicolumn{4}{|c|}{0 oder mehr 32bit Wörter}\\
            \midrule
            \multicolumn{4}{|c|}{Daten...}\\
            \bottomrule
    \end{tabular}\\ 
    Die Felder bedeuten dabei folgendes:
    \begin{description}
    \item[Source Port] Port, von dem aus das Paket geschickt wird.
    \item[Destination Port] Port, an den das Paket gesendet wird.
    \item[Sequence Number] Alle übertragenen Bytes sind durchnummeriert, beginnend bei einem zufälligen Wert.
    \item[Acknowledgement Number] Nur gültig, wenn die ACK-Flag gesetzt ist. Quittiert alle Pakete vom Gegenüber mit einer Acknowledgement Number = Sequence Number+1.
    \item[Data Offset] gibt die Zahl der 32bit-Wörter im TCP-Header an. Min 5, wenn keine Options verwendet werden.
    \item[reserved] Bits werden nicht verwendet.
    \item[Flags] Es gibt folgende Flags:
    \begin{description}
        \item[0: CWR] Für uns irrelevant
        \item[1: ECE] Für uns irrelevant
        \item[2: URG] Das Urgent Pointer Feld enthält gültige Daten
        \item[3: ACK] Die Acknowledgement Nummer ist gültig
        \item[4: PSH] Die Daten des TCP Nutzlasten-Feldes sofort an die nächsthöhere Schicht liefern. (z.B. Telnet)
        \item[5: RST] Reset: Die Verbindung soll vom Rechner, der RST sendet, zurückgesetzt werden.
        \item[6: SYN] Wird beim Verbindungsaufbau verwendet.
        \item[7: FIN] Wird beim Schließen der Verbindung verwendet.
    \end{description}
    \item[window] Teilt dem Kommunikationspartner mit, wie viele Datenbytes er noch senden darf, bevor er auf eine Quittierung warten muss.
    \item[checksum] Prüfsumme auf Fehler im Header
    \item[urgent pointer] Pointer auf das letzte Byte, was zu den Vorrangsdaten (urgent data) gehört.
    \item[options] Optionale Daten % Vllt noch genauer erklären
    \end{description}
    \subsection{UDP}
        UDP bietet einen Datagramm-Dienst für die darüberliegende Schicht an. UDP ist unzuverlässig und verbindungslos. Wird oft verwendet, wenn die Ziel-Adresse Broadcast oder Multicast ist. Der UDP-Header sieht wie folgt aus:\\
        \begin{tabular}{|p{3cm}|p{3cm}|p{3cm}|p{3cm}|}
            \toprule 
            1 & 2 & 3 & 4  \\
            \midrule\midrule
            \multicolumn{2}{|c|}{Source Port} & \multicolumn{2}{|c|}{Destination Port}\\
            \midrule
            \multicolumn{2}{|c|}{Length} & \multicolumn{2}{|c|}{Checksum}\\
            \midrule
            \multicolumn{4}{|c|}{Daten...}\\
            \bottomrule
        \end{tabular}\\ \\
        Das \textbf{Length}-Feld bezieht sich dabei auf die Länge von UDP-Header + Daten. \\
        UDP wird u. a. verwendet für:\\ 
        \begin{tabular}{|c|c|}
            \hline
            Dienst & Portnummer \\
            \hline
            Trivial File Transfer Protocol (TFTP) & 69 \\
            Domain Name Services (DNS) & 53 \\
            Simple Network Management Protocol (SNMP) & 161/162\\
            Routing Information Protocol (RIP) & 520\\
            \hline
        \end{tabular}  \\ 
\end{document}
